<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Stanford Waste Project</title>
    <link rel="stylesheet" href="main.css">
    <script src="https://cdn.jsdelivr.net/npm/interactjs@1.3/dist/interact.min.js"></script>
  </head>
  <body>
    <div id="main-container">
      <img src="images/conveyor.png" id="conveyor-image"/>
      <img src="images/cup.png" class="waste-image" id="landfill"/>

      <img src="images/stanfordTree.png" id="tree-image"/>
      <div id="bin-container">
        <img src="images/compost.png" class="bin-image" id="compost-bin"/>
        <img src="images/paper.png" class="bin-image" id="paper-bin"/>
        <img src="images/plastics.png" class="bin-image" id="plastic-bin"/>
        <img src="images/landfill.png" class="bin-image" id="landfill-bin"/>
      </div>
    </div>

    <div id="footer">
      <img src="images/stanfordLogo.png" id="stanford-logo"/>
    </div>

    <script>
      interact('#compost-bin').dropzone({
        accept: '.waste-image',
        overlap: 1.0,

        ondrop: function (event) {
          var draggableElement = event.relatedTarget;
          if(draggableElement.id=="compost"){
            console.log(draggableElement.id);
            draggableElement.remove();
          }else{
            console.log("incorrect");
            draggableElement.style.transform = "none";
            draggableElement.setAttribute("data-x",0);
            draggableElement.setAttribute("data-y",0);

          }
        }
      });

      interact('#paper-bin').dropzone({
        accept: '.waste-image',
        overlap: 1.0,

        ondrop: function (event) {
          var draggableElement = event.relatedTarget;
          if(draggableElement.id=="paper"){
            console.log(draggableElement.id);
            draggableElement.remove();
          }else{
            console.log("incorrect");
            draggableElement.style.transform = "none";
            draggableElement.setAttribute("data-x",0);
            draggableElement.setAttribute("data-y",0);

          }
        }
      });

      interact('#plastic-bin').dropzone({
        accept: '.waste-image',
        overlap: 1.0,

        ondrop: function (event) {
          var draggableElement = event.relatedTarget;
          if(draggableElement.id=="plastic"){
            console.log(draggableElement.id);
            draggableElement.remove();
          }else{
            console.log("incorrect");
            draggableElement.style.transform = "none";
            draggableElement.setAttribute("data-x",0);
            draggableElement.setAttribute("data-y",0);

          }
        }
      });

      interact('#landfill-bin').dropzone({
        accept: '.waste-image',
        overlap: 1.0,

        ondrop: function (event) {
          var draggableElement = event.relatedTarget;
          if(draggableElement.id=="landfill"){
            console.log(draggableElement.id);
            draggableElement.remove();
          }else{
            draggableElement.style.top = "30px";
            draggableElement.style.left = "50px";
          }
        }
      });

      function dragMoveListener (event) {
        var target = event.target,
            // keep the dragged position in the data-x/data-y attributes
            x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,
            y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

        // translate the element
        target.style.webkitTransform =
        target.style.transform =
          'translate(' + x + 'px, ' + y + 'px)';

        // update the posiion attributes
        target.setAttribute('data-x', x);
        target.setAttribute('data-y', y);
      }

      window.dragMoveListener = dragMoveListener;

      interact('.waste-image')
        .draggable({
          inertia: true,
          restrict: {
            restriction: "parent",
            endOnly: true,
            elementRect: { top: 0, left: 0, bottom: 1, right: 1 }
          },
          autoScroll: true,
          // dragMoveListener from the dragging demo above
          onmove: dragMoveListener,
        });
    </script>
  </body>
</html>
